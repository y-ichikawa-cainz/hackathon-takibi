```md
# タイトル: 従業員マスタへの異動予定機能追加と自動所属切替

## 要約: 
従業員マスタに異動予定日と異動先組織IDを登録する機能を追加し、指定された異動予定日に自動的に従業員の所属組織IDが切り替わるようにする。これにより、異動情報の反映漏れを防ぎ、手動更新の負担を軽減する。

## ユーザーストーリー: 
- **[誰が]**: 店舗管理担当者
- **[何のために]**: 異動予定情報を事前に登録することで、異動作業の自動化と手動更新のミスをなくすために
- **[何ができる]**: 異動予定日に自動で従業員の所属が切り替わる

## 開始条件: 
- [x] 従業員マスタ管理システムが稼働していること。
- [x] 組織マスタ管理システムが稼働していること。

## 完了条件: 
- [x] 従業員マスタに異動予定日と異動先組織IDを登録できること。
- [x] 指定された異動予定日に、従業員の所属組織IDが自動で更新されること。
- [x] 異動予定日を過ぎた異動予定データが、履歴として参照できること。
- [x] 自動更新処理が、システム負荷に影響を与えないこと。
- [x] 自動更新処理のエラー発生時に、システム管理者に通知されること。

## 実装内容: 
> 修正・新規作成が必要なモジュールとロジックの要点

1. **`src/employee_master.py` の修正:**
    - **ファイル名**: `src/employee_master.py`
    - **関数**: `add_employee()`
    - **ロジック**:
        - 異動予定日(`transfer_date`)と異動先組織ID(`transfer_org_id`)の入力を求める処理を追加。
        - CSVファイルに`transfer_date`と`transfer_org_id`のフィールドを追加。（CSV定義を変更）

    - **関数**: `list_employees()`
    - **ロジック**:
        - 異動予定日と異動先組織IDを表示するように変更。

    - **新規関数**: `update_employee_org(emp_id, new_org_id)`
    - **ロジック**:
        - 指定された従業員ID(`emp_id`)の所属組織ID(`org_id`)を、新しい組織ID(`new_org_id`)で更新する。
        - CSVファイルを読み込み、該当する従業員の行を更新し、CSVファイルに書き戻す。

2. **新規ファイル: `src/employee_transfer_scheduler.py` の作成:**
    - **目的**: 異動予定日に自動で所属組織IDを更新するバッチ処理を実装。
    - **機能**:
        - 従業員マスタファイル(`employees.csv`)を読み込み、今日の日付が異動予定日(`transfer_date`)と一致する従業員を検索。
        - `update_employee_org()`関数を呼び出し、該当従業員の所属組織IDを異動先組織ID(`transfer_org_id`)に更新。
        - 異動が完了したレコードを別の履歴ファイル（例：`employee_transfer_history.csv`）に移動または追記。
        - 定期的に実行されるようにスケジューリングする（例：cron, APSchedulerなど）。

3. **CSVファイルの定義変更**:
    - `employees.csv` のヘッダーを以下のように変更:
        ```
        emp_id,name,dept,org_id,transfer_date,transfer_org_id
        ```

4. **エラーハンドリングとロギング**:
    - `src/employee_transfer_scheduler.py` に、エラー発生時のログ出力とシステム管理者への通知処理を追加。

5. **データ型**:
    - `transfer_date` は日付型で格納する。フォーマットは `YYYY-MM-DD` を推奨。

6. **補足**:
    - 将来的なワークフロー連携を見据え、`transfer_date` と `transfer_org_id` はNULLを許容する設計とする。

## ストーリーポイント: 
- **予測値**: 8
```
